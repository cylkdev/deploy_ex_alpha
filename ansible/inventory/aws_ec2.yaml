# Fetch all hosts in us-west-1
plugin: aws_ec2
regions:
  - us-west-1

# The inventory_hostname for each host is the value of the
# tag 'Name', otherwise the public IP address.
hostnames:
  - tag:Name
  - public-ip-address

# Only target hosts that are a part of this deployment group.
filters:
  tag:Group: 'requis_backend'

# Add hosts to group based on the values of a variable.
keyed_groups:
  - key: tags['InstanceGroup']
    prefix: "group"

# Use the public IP address to connect to the host
# (note: this does not modify inventory_hostname)
compose:
  ansible_host: public_ip_address